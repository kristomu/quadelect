/* zmgd.c: Ziggurat Method Generator of Zero-Mean Gaussians (double version)
 *
 * Copyright 2019 Frank R. Kschischang <frank@ece.utoronto.ca>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * For additional information about ZMG, visit
 *
 *     http://www.comm.utoronto.ca/frank/ZMG
 */
#include <stdio.h> /* needed for fprintf() */
#include <math.h>  /* needed for exp() and log() */
#include <stdlib.h> /* needed for exit() */
//#include <unistd.h> /* needed for getentropy() */
#include "zmg.h"

/********************************************************************
This data was auto-generated on Mon 14 Jan 2019 12:38:48
 ZMG_R      = number of rectangles
 ZMG_MR     = number of bits to mask for rectangle selection
 ZMG_RMASK  = rectangle selection mask
 ZMG_T      = number of trapezoids + 1 for tail
 ZMG_MT     = number of bits to mask for trapezoid selection
 ZMG_TMASK  = trapezoid+tail selection mask
 ZMG_A      = start of tail
 ZMG_LAMBDA = parameter of exp dist for tail sampling
 ZMG_K      = -1/LAMBDA
********************************************************************/
#define ZMG_R 253
#define ZMG_MR 8
#define ZMG_RMASK 255
#define ZMG_T 264
#define ZMG_MT 10
#define ZMG_TMASK 1023
#define ZMG_A 3.636006625500945586057259351695125644072
#define ZMG_LAMBDA 3.892885488964749638573514574787539356493
#define ZMG_K (-0.2568788634638040525162552230924137124217)
/* Rectangle width scaled by 2^-55 */
static double ZMG_Rect[253]=
{8.09691899030576e-18,9.63225260093562e-18,1.07721734575574e-17,1.17106539240334e-17,1.2522248120934e-17,1.32449719665905e-17,1.3901264289509e-17,1.45056448297193e-17,1.50681276353477e-17,1.559595201236e-17,1.60945445921545e-17,1.65680922483617e-17,1.70199022044668e-17,1.74526384498686e-17,1.78684826216348e-17,1.82692468335425e-17,1.86564548626889e-17,1.90314018760922e-17,1.93951992267437e-17,1.97488086274393e-17,2.00930686172346e-17,2.04287153367383e-17,2.07563990346572e-17,2.10766973269979e-17,2.13901259541664e-17,2.16971475876466e-17,2.19981791000607e-17,2.22935976127724e-17,2.25837455621959e-17,2.28689349718435e-17,2.31494510765378e-17,2.34255554144355e-17,2.36974884789471e-17,2.39654720044348e-17,2.42297109453909e-17,2.44903951976619e-17,2.47477011014716e-17,2.50017927589775e-17,2.52528231934617e-17,2.55009353727162e-17,2.57462631154899e-17,2.59889318968558e-17,2.62290595658847e-17,2.64667569869708e-17,2.67021286144705e-17,2.69352730089035e-17,2.7166283301794e-17,2.73952476152413e-17,2.76222494414762e-17,2.78473679869578e-17,2.80706784849658e-17,2.8292252480137e-17,2.85121580879562e-17,2.87304602318413e-17,2.8947220860141e-17,2.91624991450856e-17,2.9376351665493e-17,2.95888325748246e-17,2.97999937560041e-17,3.00098849642549e-17,3.02185539590761e-17,3.04260466263541e-17,3.06324070915021e-17,3.08376778244275e-17,3.10418997370425e-17,3.12451122739657e-17,3.14473534969909e-17,3.16486601638507e-17,3.18490678017447e-17,3.20486107760624e-17,3.22473223546867e-17,3.24452347682316e-17,3.26423792665324e-17,3.28387861716806e-17,3.30344849278684e-17,3.32295041482849e-17,3.34238716592847e-17,3.36176145420327e-17,3.38107591718095e-17,3.40033312551476e-17,3.41953558649556e-17,3.43868574737726e-17,3.45778599852874e-17,3.47683867642421e-17,3.49584606648341e-17,3.51481040577208e-17,3.53373388557219e-17,3.55261865383106e-17,3.57146681749735e-17,3.59028044475195e-17,3.60906156714056e-17,3.6278121816149e-17,3.64653425248857e-17,3.66522971331333e-17,3.68390046868132e-17,3.70254839595824e-17,3.72117534695205e-17,3.73978314952195e-17,3.75837360913148e-17,3.77694851034992e-17,3.79550961830556e-17,3.81405868009439e-17,3.83259742614743e-17,3.85112757155999e-17,3.86965081738567e-17,3.88816885189803e-17,3.90668335182259e-17,3.92519598354168e-17,3.94370840427477e-17,3.96222226323642e-17,3.98073920277429e-17,3.99926085948935e-17,4.01778886534039e-17,4.03632484873492e-17,4.05487043560846e-17,4.07342725049408e-17,4.09199691758425e-17,4.11058106178678e-17,4.12918130977662e-17,4.14779929104556e-17,4.16643663895134e-17,4.1850949917682e-17,4.20377599374057e-17,4.22248129614164e-17,4.24121255833862e-17,4.25997144886663e-17,4.2787596465128e-17,4.29757884141262e-17,4.31643073616035e-17,4.33531704693539e-17,4.3542395046466e-17,4.37319985609655e-17,4.39219986516771e-17,4.41124131403287e-17,4.43032600439175e-17,4.44945575873625e-17,4.46863242164665e-17,4.48785786112113e-17,4.50713396994128e-17,4.5264626670762e-17,4.54584589912792e-17,4.56528564182124e-17,4.58478390154082e-17,4.60434271691897e-17,4.6239641604773e-17,4.643650340326e-17,4.66340340192445e-17,4.68322552990709e-17,4.70311894997885e-17,4.72308593088459e-17,4.74312878645729e-17,4.76324987775e-17,4.78345161525695e-17,4.8037364612295e-17,4.82410693209304e-17,4.84456560097119e-17,4.86511510032444e-17,4.88575812471036e-17,4.90649743367349e-17,4.92733585477329e-17,4.94827628675915e-17,4.96932170290231e-17,4.99047515449505e-17,5.01173977452838e-17,5.03311878156028e-17,5.05461548378756e-17,5.07623328333521e-17,5.09797568077839e-17,5.11984627991348e-17,5.14184879279553e-17,5.16398704506146e-17,5.1862649815594e-17,5.20868667230673e-17,5.23125631880084e-17,5.25397826070928e-17,5.27685698296759e-17,5.29989712331625e-17,5.32310348031069e-17,5.34648102184125e-17,5.37003489420377e-17,5.393770431765e-17,5.4176931672712e-17,5.44180884285315e-17,5.46612342178575e-17,5.49064310106633e-17,5.51537432488208e-17,5.54032379904423e-17,5.56549850647471e-17,5.5909057238399e-17,5.61655303943619e-17,5.64244837244353e-17,5.66859999367584e-17,5.6950165479714e-17,5.72170707838308e-17,5.74868105234618e-17,5.77594839002302e-17,5.80351949504699e-17,5.83140528791601e-17,5.85961724231619e-17,5.88816742469228e-17,5.91706853742176e-17,5.9463339659965e-17,5.97597783066994e-17,6.00601504308991e-17,6.03646136850978e-17,6.06733349425454e-17,6.09864910521668e-17,6.13042696727126e-17,6.16268701963415e-17,6.19545047734604e-17,6.22873994525164e-17,6.26257954506559e-17,6.29699505738054e-17,6.33201408078828e-17,6.36766621066321e-17,6.40398324061342e-17,6.44099939015639e-17,6.47875156284735e-17,6.5172796399087e-17,6.55662681541622e-17,6.59683998034297e-17,6.63797016430874e-17,6.68007304581738e-17,6.72320954419928e-17,6.76744650956202e-17,6.81285753099265e-17,6.8595238883255e-17,6.90753567936985e-17,6.95699316310811e-17,7.00800837076704e-17,7.06070705188127e-17,7.1152310430228e-17,7.17174117497012e-17,7.23042087300976e-17,7.29148065973794e-17,7.35516384773793e-17,7.42175382271423e-17,7.49158348505387e-17,7.56504767047726e-17,7.64261976082056e-17,7.72487431490166e-17,7.81251855977148e-17,7.90643728788583e-17,8.00775869620072e-17,8.11795418671115e-17,8.23899574591875e-17,8.37361633731009e-17,8.52576726024708e-17,8.70148535600183e-17,8.9107139165543e-17,9.17171826704094e-17,9.52446592105447e-17,1.00919456833019e-16};
static double ZMG_Trap[1578]=
{0.204456131663835,0.00142668987610155,-0.00697797549279324,3.53377855966903,0.00205981067729133,0.000117630066716325,0.12709073625369,0.00148156089286709,-0.0116575049963492,3.36800512571027,0.00351393606177565,0.0000720873971793285,0.0940367276474959,0.00152495739758831,-0.016216614888012,3.25744139375967,0.00501719520700335,0.000052813686740502,0.0753825333871519,0.00156162523395733,-0.0207160089186322,3.17273176324235,0.00656048652277617,0.0000420124898462945,0.0633091160450683,0.00159381070231664,-0.0251750585363101,3.10338593852624,0.00813820449091315,0.0000350579088865402,0.0548181471874456,0.00162277068323478,-0.0296028006507747,3.04432230690998,0.00974649518368886,0.0000301865159745322,0.0485021796181175,0.0016492858503506,-0.0340043656457561,2.9926621435072,0.0113825234504816,0.000026574598155271,0.0436098176754934,0.0016738772838958,-0.0383830378826931,2.94660614486039,0.0130441050176048,0.0000237841856258072,0.0397021096000544,0.00169691166034881,-0.0427410955599822,2.90495018122262,0.0147294994897271,0.0000215603000667022,0.0365048845385282,0.00171865767223155,-0.047080211154144,2.86684668415333,0.0164372841560172,0.0000197441484700174,0.0338377879151108,0.00173931863340624,-0.0514016648419714,2.83167534792651,0.0181662723088361,0.0000182315409188585,0.0315771670829527,0.00175905245197709,-0.055706468137439,2.79896787042748,0.0199154578515278,0.0000169512051238872,0.0296353263287316,0.00177798445168017,-0.0599954403051877,2.76836162372164,0.0216839763033564,0.0000158526959266644,0.0279482909731557,0.0017962159257597,-0.0642692580911287,2.73956981507069,0.0234710764920764,0.0000148992800853266,0.0264682622478303,0.00181383003098776,-0.0685284894793742,2.7123615384602,0.0252760994704501,0.00001406355765723,0.0251587873033739,0.00183089596198343,-0.0727736174206577,2.6865480136846,0.0270984624669357,0.0000133246641959991,0.0239915669191909,0.00184747197834644,-0.0770050570089544,2.66197283657331,0.0289376464371006,0.0000126664247073108,0.0229442865397212,0.00186360764554657,-0.0812231682305872,2.63850490984386,0.0307931862490472,0.0000120761013155637,0.0219991066205077,0.0018793455240713,-0.0854282656332672,2.61603321326374,0.0326646628338561,0.0000115435228541221,0.0211415892980441,0.00189472246325164,-0.0896206257978405,2.59446286530447,0.0345516968275176,0.0000110604668453227,0.02035992073445,0.00190977060655922,-0.0938004932076079,2.57371211028822,0.036453943362423,0.0000106202122839313,0.0196443380950185,0.00192451818281033,-0.0979680849261272,2.55370998087349,0.0383710877571078,0.0000102172104840306,0.0189867008503162,0.00193899013613126,-0.102123594373636,2.53439446140082,0.0403028419165786,9.84683909688354e-6,0.0183801656162401,0.00195320863284733,-0.106267194410998,2.51571102816754,0.0422489413010679,9.50521572970916e-6,0.0178189364267436,0.00196719347327095,-0.110399039884248,2.49761147714605,0.044209142354127,9.18905494165777e-6,0.0172980707405369,0.00198096242918103,-0.114519269743693,2.48005297356241,0.046183220305353,8.89555725784682e-6,0.0168133271595994,0.0019945315226433,-0.118628008823616,2.46299727461234,0.0481709672812652,8.6223221236625e-6,0.0163610447354798,0.0020079152580878,-0.122725369348421,2.4464100886648,0.0501721906716307,8.3672789726245e-6,0.0159380464578904,0.00202112681681424,-0.126811452216194,2.43026054306812,0.0521867117090817,8.12863214952309e-6,0.0155415614431034,0.00203417822105266,-0.130886348099555,2.41452073911762,0.0542143642280152,7.90481653898307e-6,0.0151691617178842,0.00204708047317017,-0.134950138395367,2.39916537753713,0.0562549935751266,7.69446154335778e-6,0.0148187104945526,0.0020598436744461,-0.139002896048432,2.38417144143091,0.0583084556489347,7.49636162922237e-6,0.01448831956636,0.00207247712694168,-0.143044686269463,2.36951792640045,0.0603746160496286,7.30945208355099e-6,0.0141763139962997,0.00208498942129679,-0.147075567163722,2.35518560961912,0.0624533493237479,7.13278893318472e-6,0.0138812026797438,0.00209738851274467,-0.151095590283779,2.3411568512811,0.0645445382907686,6.96553221503569e-6,0.0136016536690745,0.00210968178720984,-0.15510480111742,2.32741542310669,0.0666480734407458,6.806931961058e-6,0.0133364733830713,0.00212187611901698,-0.159103239519857,2.31394635958062,0.0687638523938593,6.65631639652404e-6,0.0130845890040799,0.0021339779214695,-0.163090940097858,2.30073582838704,0.0708917794141025,6.51308195343775e-6,0.0128450335055766,0.00214599319134031,-0.167067932552192,2.28777101713221,0.0730317649705074,6.37668478084747e-6,0.0126169328615974,0.00215792754814313,-0.171034241983747,2.27504003394863,0.0751837253402491,6.24663349612278e-6,0.0123994950749902,0.00216978626891043,-0.174989889167897,2.26253181998033,0.0773475822487759,6.12248297015187e-6,0.0121920007289981,0.00218157431908865,-0.178934890800973,2.25023607207834,0.0795232625427754,6.00382897803444e-6,0.011993794820402,0.00219329638006622,-0.182869259722147,2.23814317430364,0.0817106978923529,5.89030357753506e-6,0.0118042796754112,0.00220495687377116,-0.186793005113575,2.22624413705573,0.0839098245192716,5.78157110209341e-6,0.0116229087840364,0.00221655998471034,-0.190706132681235,2.21453054282601,0.0861205829485123,5.67732467490573e-6,0.0114491814166085,0.00222810967976814,-0.194608644818571,2.20299449772569,0.0883429177807515,5.57728316652333e-6,0.0112826379087993,0.00223960972603701,-0.198500540754778,2.19162858806298,0.0905767774836541,5.48118853135171e-6,0.0111228555200189,0.0022510637069143,-0.202381816689325,2.18042584134857,0.0928221142001298,5.3888034689897e-6,0.0109694447852573,0.00226247503666787,-0.206252465914099,2.16937969119593,0.0950788835719209,5.29990936500107e-6,0.0108220462929469,0.0022738469736457,-0.210112478924402,2.15848394565683,0.0973470445770777,5.21430447283411e-6,0.0106803278317693,0.00228518263228181,-0.213961843519859,2.14773275859447,0.0996265593800414,5.13180230449347e-6,0.0105439818579226,0.0022964849940311,-0.21780054489619,2.13712060374963,0.101917393193198,5.0522302024566e-6,0.0104127232415259,0.00230775691734899,-0.221628565728672,2.1266422511999,0.104219514148888,4.97542806939936e-6,0.0102862872568284,0.00231900114681746,-0.225445886248027,2.11629274595073,0.106532893180971,4.9012472357011e-6,0.0101644277859239,0.00233022032150655,-0.229252484309399,2.10606738842935,0.108857503915133,4.82954944755784e-6,0.0100469157099049,0.00234141698264987,-0.233048335454985,2.09596171668144,0.111193322567211,4.76020596093857e-6,0.00993353746497343,0.00235259358070346,-0.236833412970849,2.085971490094,0.113540327848888,4.69309672865345e-6,0.00982409374406414,0.00236375248184918,-0.24060768793838,2.07609267448948,0.115898500880164,4.62810966952556e-6,0.00971839832711266,0.00237489597399709,-0.244371129280793,2.06632142845389,0.118267825108087,4.56514001012295e-6,0.00961627702530853,0.00238602627233505,-0.248123703805059,2.05665409077768,0.120648286231254,4.50408969075646e-6,0.00951756672655272,0.00239714552446857,-0.251865376239587,2.04708716890175,0.123039872129655,4.44486682851647e-6,0.00942211453095589,0.00240825581518931,-0.255596109267947,2.03761732827299,0.125442572799484,4.38738523103731e-6,0.00932977696660194,0.00241935917090648,-0.259315863558918,2.02824138252422,0.127856380292532,4.33156395546447e-6,0.00924041927699846,0.00243045756377196,-0.263024597793081,2.01895628440242,0.130281288659871,4.27732690777788e-6,0.00915391477267025,0.00244155291552666,-0.266722268686192,2.00975911737758,0.132717293899521,4.22460247821041e-6,0.00907014424024778,0.00245264710109304,-0.27040883100951,2.00064708787112,0.135164393907831,4.17332320900721e-6,0.00898899540318052,0.00246374195193599,-0.27408423760727,1.99161751804941,0.137622588434345,4.12342549121238e-6,0.0089103624288818,0.00247483925921239,-0.277748439411456,1.98266783913338,0.140091879039919,4.07484928755158e-6,0.0088341454777019,0.00248594077672753,-0.281401385454003,1.97379558518009,0.142572269057889,4.02753787881334e-6,0.00876025028964181,0.00249704822371492,-0.285043022876578,1.96499838729641,0.14506376355811,3.98143763142298e-6,0.00868858780517156,0.00250816328745448,-0.288673296938035,1.95627396824901,0.147566369313695,3.93649778415845e-6,0.00861907381691312,0.00251928762574274,-0.292292151019656,1.94762013743796,0.150080094770294,3.89267025218084e-6,0.00855162864929581,0.00253042286922745,-0.295899526628278,1.93903478620486,0.152604950017779,3.84990944674908e-6,0.00848617686359908,0.00254157062361795,-0.299495363397369,1.93051588344841,0.155140946764202,3.80817210916148e-6,0.00842264698606757,0.00255273247178157,-0.303079599086156,1.92206147152358,0.157688098311901,3.76741715761905e-6,0.00836097125702254,0.00256390997573554,-0.306652169576837,1.91366966240203,0.16024641953566,3.72760554584072e-6,0.0083010853991054,0.00257510467854309,-0.310213008869974,1.90533863407397,0.162815926862799,3.68870013237974e-6,0.00824292840297637,0.00258631810612178,-0.313762049078081,1.89706662717293,0.165396638255132,3.65066555969618e-6,0.00818644232895828,0.00259755176897114,-0.317299220417483,1.88885194180696,0.167988573192678,3.61346814213447e-6,0.00813157212326334,0.00260880716382673,-0.320824451198469,1.88069293458085,0.170591752659077,3.57707576203847e-6,0.00807826544757304,0.00262008577524646,-0.324337667813777,1.87258801579543,0.173206199128614,3.54145777331065e-6,0.00802647252085891,0.00263138907713524,-0.327838794725439,1.86453564681122,0.175831936554804,3.50658491178849e-6,0.00797614597243739,0.00264271853421322,-0.331327754450016,1.85653433756457,0.178468990360479,3.47242921187027e-6,0.00792724070534586,0.00265407560343242,-0.334804467542232,1.84858264422568,0.181117387429301,3.43896392887559e-6,0.00787971376921163,0.00266546173534666,-0.338268852577032,1.8406791669884,0.183777156098691,3.40616346667305e-6,0.00783352424186133,0.00267687837543878,-0.34172082613007,1.83282254798286,0.186448326154084,3.37400331015033e-6,0.00778863311898595,0.00268832696540952,-0.345160302756632,1.82501146930244,0.189130928824508,3.34245996214e-6,0.00774500321123828,0.0026998089444315,-0.348587194969006,1.81724465113733,0.191824996779428,3.3115108844488e-6,0.00770259904819439,0.00271132575037205,-0.352001413212288,1.80952085000761,0.19453056412683,3.28113444266866e-6,0.00766138678866083,0.00272287882098824,-0.355402865838626,1.80183885708918,0.19724766641251,3.25130985447623e-6,0.00762133413685357,0.00273446959509712,-0.358791459079897,1.79419749662642,0.199976340620553,3.22201714115213e-6,0.00758241026401607,0.00274609951372426,-0.362167097018801,1.78659562442599,0.202716625174964,3.19323708207423e-6,0.00754458573507974,0.00275777002123348,-0.365529681558365,1.77903212642644,0.205468559942443,3.16495117195962e-6,0.00750783244000412,0.00276948256644026,-0.368879112389826,1.7715059173389,0.208232186236279,3.1371415806485e-6,0.00747212352946384,0.00278123860371172,-0.372215286958898,1.76401593935417,0.211007546821355,3.10979111523999e-6,0.00743743335457694,0.00279303959405533,-0.375538100430374,1.75656116091215,0.213794685920239,3.08288318440524e-6,0.00740373741039425,0.00280488700619897,-0.378847445651049,1.74914057552966,0.216593649220366,3.05640176471674e-6,0.00737101228289199,0.00281678231766454,-0.382143213110939,1.74175320068302,0.219404483882298,3.0303313688456e-6,0.00733923559923061,0.00282872701583731,-0.385425290902755,1.73439807674196,0.222227238549049,3.00465701548979e-6,0.00730838598106175,0.00284072259903327,-0.388693564679595,1.72707426595181,0.225061963356484,2.97936420090675e-6,0.00727844300068228,0.00285277057756654,-0.39194791761083,1.71978085146094,0.227908709944784,2.95443887193309e-6,0.00724938713985036,0.00286487247481889,-0.39518823033612,1.71251693639067,0.230767531470977,2.929867400383e-6,0.00722119975109267,0.00287702982831346,-0.398414380917537,1.7052816429452,0.233638482622543,2.90563655872442e-6,0.00719386302134541,0.00288924419079465,-0.401626244789729,1.69807411155898,0.236521619632097,2.88173349693929e-6,0.00716735993778342,0.00290151713131616,-0.40482369470808,1.69089350007942,0.239417000293152,2.85814572048096e-6,0.00714167425570332,0.0029138502363392,-0.408006600694818,1.68373898298267,0.24232468397698,2.83486106924716e-6,0.00711679046833648,0.00292624511084283,-0.411174829982992,1.67660975062065,0.245244731650571,2.81186769749296e-6,0.00709269377847717,0.00293870337944833,-0.414328246958278,1.66950500849725,0.248177205895717,2.78915405461256e-6,0.00706937007181983,0.00295122668755974,-0.41746671309853,1.6624239765721,0.251122170929221,2.76670886672345e-6,0.00704680589190757,0.00296381670252242,-0.42059008691101,1.65536588859023,0.254079692624262,2.74452111899049e-6,0.00702498841660107,0.00297647511480174,-0.423698223867231,1.64832999143598,0.257049838532924,2.72258003863126e-6,0.00700390543598425,0.00298920363918395,-0.426790976335317,1.64131554450969,0.260032677909917,2.70087507854698e-6,0.00698354533162912,0.00300200401600128,-0.429868193509811,1.63432181912588,0.263028281737509,2.679395901527e-6,0.00696389705714819,0.00301487801238347,-0.432929721338831,1.62734809793149,0.266036722751702,2.65813236497688e-6,0.00694495011996829,0.00302782742353788,-0.435975402448492,1.62039367434293,0.269058075469662,2.63707450612311e-6,0.00692669456426458,0.0030408540740604,-0.439005076064482,1.61345785200082,0.272092416218461,2.61621252764937e-6,0.00690912095499842,0.00305395981927957,-0.442018577930696,1.60653994424119,0.275139823165131,2.59553678372148e-6,0.00689222036300704,0.00306714654663618,-0.445015740224824,1.59963927358218,0.278200376348089,2.57503776635971e-6,0.00687598435109709,0.00308041617710088,-0.447996391470756,1.59275517122513,0.281274157709958,2.55470609211884e-6,0.00686040496109801,0.00309377066663239,-0.450960356447709,1.58588697656903,0.284361251131825,2.53453248903761e-6,0.00684547470183481,0.00310721200767885,-0.453907456095925,1.57903403673757,0.28746174246898,2.51450778382048e-6,0.00683118653798317,0.0031207422307252,-0.456837507418815,1.57219570611766,0.290575719588182,2.4946228892154e-6,0.00681753387977307,0.00313436340588936,-0.459750323381406,1.56537134590878,0.293703272406489,2.47486879155234e-6,0.00680451057351015,0.00314807764457032,-0.462645712804935,1.55856032368214,0.296844492931719,2.45523653840776e-6,0.00679211089288685,0.00316188710115114,-0.465523480257437,1.55176201294894,0.29999947530458,2.43571722636087e-6,0.00678032953105821,0.00317579397476024,-0.468383425940154,1.54497579273697,0.303168315842536,2.41630198880764e-6,0.00676916159345975,0.00318980051109446,-0.47122534556959,1.53820104717471,0.306351113085463,2.39698198379883e-6,0.00675860259134741,0.00320390900430737,-0.474049030255029,1.5314371650823,0.309547967843164,2.37774838186828e-6,0.00674864843604192,0.00321812179896671,-0.476854266371318,1.52468353956861,0.312758983244801,2.35859235381751e-6,0.00673929543386221,0.00323244129208498,-0.479640835426695,1.51793956763366,0.315984264790327,2.33950505842236e-6,0.00673054028173503,0.00324686993522732,-0.482408513925472,1.51120464977586,0.319223920403983,2.32047763002697e-6,0.00672238006346979,0.00326141023670115,-0.485157073225305,1.50447818960326,0.322478060489947,2.30150116598974e-6,0.00671481224668999,0.00327606476383222,-0.487886279388843,1.49775959344818,0.325746797990214,2.28256671394496e-6,0.00670783468041477,0.00329083614533209,-0.490595893029464,1.49104826998462,0.329030248444796,2.26366525884316e-6,0.00670144559328604,0.00330572707376218,-0.493285669150858,1.48434362984777,0.332328530054343,2.24478770973159e-6,0.00669564359243903,0.00332074030809991,-0.495955356980144,1.47764508525491,0.335641763745274,2.22592488623527e-6,0.00669042766301575,0.00333587867641295,-0.498604699794225,1.47095204962718,0.338970073237531,2.2070675046973e-6,0.00668579716832351,0.00335114507864752,-0.501233434739066,1.46426393721151,0.342313585115061,2.18820616393523e-6,0.00668175185064223,0.00336654248953762,-0.503841292641545,1.45758016270203,0.345672428899153,2.16933133056867e-6,0.00667829183268685,0.00338207396164193,-0.506427997813513,1.45090014086037,0.349046737124743,2.15043332387052e-6,0.00667541761973311,0.00339774262851603,-0.508993267847694,1.44422328613416,0.352436645419822,2.13150230009224e-6,0.0066731301024173,0.0034135517080276,-0.511536813405011,1.43754901227308,0.355842292588094,2.11252823621027e-6,0.00667143056022293,0.00342950450582328,-0.514058337992906,1.43087673194176,0.359263820695019,2.09350091303815e-6,0.00667032066566968,0.00344560441895588,-0.516557537734201,1.42420585632882,0.362701375157409,2.07440989764493e-6,0.00666980248922245,0.00346185493968172,-0.519034101126028,1.41753579475137,0.366155104836728,2.05524452501707e-6,0.00666987850494108,0.00347825965943802,-0.521487708788294,1.41086595425429,0.369625162136288,2.03599387889687e-6,0.00667055159689388,0.00349482227301145,-0.523918033201154,1.40419573920337,0.373111703102512,2.01664677172546e-6,0.00667182506636117,0.00351154658290925,-0.526324738430897,1.39752455087174,0.376614887530473,1.99719172361402e-6,0.00667370263985814,0.00352843650394534,-0.528707479843654,1.39085178701863,0.3801348790739,1.97761694026079e-6,0.00667618847800925,0.00354549606805479,-0.53106590380624,1.3841768414597,0.3836718453599,1.95791028972564e-6,0.00667928718531041,0.00356272942935066,-0.533399647373462,1.37749910362804,0.387225958108603,1.93805927796731e-6,0.00668300382081834,0.00358014086943848,-0.535708337961131,1.37081795812498,0.390797393257997,1.91805102304089e-6,0.00668734390981077,0.00359773480300469,-0.537991593003999,1.36413278425966,0.394386331094219,1.89787222784541e-6,0.00669231345646528,0.00361551578369633,-0.54024901959777,1.35744295557652,0.39799295638757,1.8775091513021e-6,0.00669791895760922,0.00363348851031098,-0.542480214124288,1.35074783936949,0.401617458534573,1.85694757783458e-6,0.00670416741759786,0.00365165783331674,-0.544684761858939,1.34404679618188,0.405260031706387,1.83617278501132e-6,0.00671106636438346,0.00367002876172422,-0.546862236559239,1.33733917929089,0.408920875003908,1.81516950919885e-6,0.00671862386684356,0.00368860647033352,-0.549012200033523,1.33062433417528,0.412600192619936,1.79392190906162e-6,0.00672684855344293,0.00370739630738146,-0.551134201688537,1.32390159796513,0.416298194008794,1.77241352672953e-6,0.00673574963231056,0.00372640380261592,-0.553227778054698,1.31717029887226,0.420015094063793,1.75062724643909e-6,0.00674533691282027,0.00374563467582651,-0.55529245228767,1.31042975559969,0.423751113303014,1.72854525043612e-6,0.00675562082877146,0.00376509484586285,-0.557327733644807,1.3036792767289,0.427506478063859,1.70614897190933e-6,0.00676661246327539,0.0037847904401745,-0.55933311693492,1.29691816008287,0.431281420706877,1.68341904470241e-6,0.00677832357546176,0.00380472780490916,-0.561308081939711,1.2901456920635,0.435076179829419,1.6603352495292e-6,0.0067907666291309,0.00382491351560887,-0.563252092805079,1.28336114696121,0.438891000489678,1.6368764563903e-6,0.00680395482348809,0.00384535438854709,-0.565164597400391,1.2765637862349,0.442726134441756,1.61302056286075e-6,0.00681790212610926,0.00386605749275336,-0.567045026643641,1.2697528577601,0.446581840382406,1.58874442788667e-6,0.00683262330830093,0.00388703016277593,-0.568892793790284,1.26292759504289,0.450458384210171,1.56402380069306e-6,0.0068481339830324,0.00390828001223738,-0.570707293683348,1.25608721639723,0.454356039297678,1.5388332443657e-6,0.00686445064563483,0.00392981494824271,-0.572487901962224,1.24923092408289,0.458275086777918,1.51314605362631e-6,0.00688159071748028,0.00395164318670491,-0.574233974227373,1.24235790340134,0.462215815845391,1.48693416627109e-6,0.00689957259287395,0.00397377326865853,-0.575944845157908,1.23546732174616,0.466178524073073,1.46016806768857e-6,0.00691841568941528,0.0039962140776385,-0.577619827578797,1.22855832760502,0.470163517746222,1.43281668781169e-6,0.00693814050210861,0.00401897485820795,-0.579258211474172,1.22163004950925,0.474171112214145,1.40484728979109e-6,0.00695876866153126,0.00404206523572716,-0.580859262942894,1.21468159492743,0.478201632261112,1.37622534960069e-6,0.00698032299639769,0.00406549523746389,-0.582422223092249,1.20771204909847,0.482255412497708,1.34691442570126e-6,0.00700282760089229,0.00408927531515512,-0.583946306865254,1.20072047379982,0.486332797774017,1.31687601779225e-6,0.00702630790718127,0.00411341636914071,-0.585430701796683,1.19370590604579,0.490434143616165,1.28606941357488e-6,0.00705079076355594,0.00413792977420127,-0.586874566692486,1.18666735671042,0.494559816687836,1.25445152232894e-6,0.00707630451870719,0.00416282740724559,-0.588277030226805,1.17960380906929,0.49871019527856,1.22197669397014e-6,0.00710287911268326,0.00418812167700743,-0.589637189450249,1.17251421725359,0.502885669820686,1.18859652210258e-6,0.00713054617514196,0.00421382555592796,-0.590954108202528,1.16539750460968,0.507086643437154,1.15425962940878e-6,0.00715933913157457,0.00423995261441786,-0.592226815421908,1.15825256195632,0.511313532522327,1.11891143352684e-6,0.00718929331825284,0.00426651705771377,-0.593454303343215,1.15107824573141,0.515566767358393,1.08249389134662e-6,0.00722044610673422,0.00429353376556631,-0.594635525575338,1.14387337601891,0.519846792770033,1.04494521941293e-6,0.00725283703885432,0.00432101833502232,-0.595769395048326,1.13663673444612,0.524154068820327,1.00619958785051e-6,0.00728650797324204,0.00434898712659288,-0.596854781819151,1.12936706194007,0.528489071551135,9.66186784922263e-7,0.00732150324451314,0.00437745731413062,-0.597890510724168,1.12206305633119,0.532852293771496,9.24831848998383e-7,0.00735786983643376,0.00440644693877656,-0.598875358865045,1.11472336979072,0.53724424589795,8.82054664354383e-7,0.00739565757050045,0.00443597496737768,-0.599808052913611,1.10734660608725,0.541665456851027,8.37769516843277e-7,0.00743491931155868,0.00446606135582292,-0.600687266219522,1.09993131764622,0.546116475012627,7.91884605129571e-7,0.00747571119228216,0.00449672711779822,-0.601511615702943,1.0924760023943,0.550597869249438,7.44301502894891e-7,0.00751809285856394,0.00452799439952135,-0.602279658512526,1.08497910036888,0.555110230008098,6.94914567365367e-7,0.00756212773813179,0.0045598865610852,-0.602989888426787,1.07743899007053,0.559654170488401,6.43610289975756e-7,0.00760788333500023,0.00459242826511655,-0.603640731974555,1.06985398453397,0.564230327901502,5.90266586677925e-7,0.00765543155271615,0.00462564557354627,-0.604230544247384,1.06222232709011,0.568839364820833,5.34752030026978e-7,0.00770484904975182,0.00465956605338899,-0.604757604373713,1.05454218678887,0.573481970634301,4.76925037188472e-7,0.00775621763085707,0.00469421889254774,-0.605220110620984,1.04681165344857,0.578158863107269,4.16633060174001e-7,0.00780962467871262,0.0047296350267939,-0.605616175087887,1.03902873229378,0.58287079006694,3.53711918294386e-7,0.00786516363084141,0.00476584727922875,-0.605943817944306,1.03119133813901,0.587618531219952,2.87985725341416e-7,0.00792293450744995,0.0048028905137131,-0.60620096117126,1.02329728906986,0.592402900116422,2.19269143165211e-7,0.00798304449670604,0.00484080180396081,-0.606385421747081,1.01534429956778,0.597224746275259,1.47380931636249e-7,0.00804560860493466,0.00487962062023482,-0.606494904219175,1.00732997301696,0.602084957487357,7.22536367073494e-8,0.00330716871449619,0.00200589191515882,-0.606528450262143,1.00165358435725,0.605527713755054,2.81198213502125e-9,0.00480358166586182,0.00692529778142841,-0.60652715808425,0.997598209167069,0.607987416688189,1.12230559808893e-8,0.00817860272035194,0.00496033317322577,-0.606482551990995,0.991107116973962,0.611924323419956,1.04555225379305e-7,0.00824930877377957,0.0050023134108683,-0.606352163158476,0.982893161226896,0.616905465494945,1.92442573575326e-7,0.00832302295184378,0.0050453967285306,-0.606136319446979,0.974606995364085,0.621928964526408,2.84967704769345e-7,0.00839991206313454,0.0050896388955677,-0.605832025188937,0.966245527856596,0.626995942255839,3.82494670114232e-7,0.00848015659121075,0.00513509979133956,-0.605436110255162,0.957805493529423,0.632107577525147,4.85423917603417e-7,0.00856395213624369,0.00518184380970764,-0.60494521577146,0.949283439165696,0.637265110516552,5.94196829808421e-7,0.00865151104607682,0.00522994031374813,-0.604355778310579,0.940675707574536,0.642469847413055,7.09300944188184e-7,0.00874306426667328,0.00527946414827196,-0.603664012357046,0.93197841991816,0.647723165532154,8.31275977228603e-7,0.00883886344751217,0.00533049621910343,-0.602865890810011,0.923187456061068,0.653026518993486,9.6072079868638e-7,0.00893918334429322,0.00538312414971693,-0.601957123250697,0.914298432665165,0.658381444990562,1.0983015331426e-6,0.00904432456961538,0.0054374430278315,-0.600933131655034,0.905306678708211,0.663789570748015,1.24476100450536e-6,0.0091546167524916,0.00549355625700478,-0.599789023176927,0.896207208047157,0.669252621259175,1.40092978710317e-6,0.00927042218014203,0.00555157653126188,-0.598519559561214,0.88699468858084,0.674772427914787,1.56773918728806e-6,0.00939214001111103,0.00561162695448605,-0.597119122665076,0.877663407485214,0.680350938152945,1.74623655558831e-6,0.00952021116821283,0.00567384233087247,-0.595581675469015,0.868207231895552,0.685990226283517,1.93760342615389e-6,0.00965512404422166,0.00573837065844967,-0.593900717839292,0.858619564289335,0.691692505668507,2.14317710386213e-6,0.00979742118403393,0.00580537486482495,-0.592069236157149,0.848893291675207,0.697460142474161,2.36447647853925e-6,0.00994770714617325,0.00587503483333743,-0.590079645749165,0.839020727510103,0.703295671252721,2.60323305191512e-6,0.0101066577965807,0.0059475497792734,-0.587923724827989,0.828993545038726,0.709201812663721,2.86142843207371e-6,0.0102750313521503,0.00602314105048042,-0.585592538371223,0.818802700464361,0.715181493709193,3.1413399042942e-6,0.010453681575248,0.00610205544565084,-0.583076350011509,0.808438344000662,0.721237870937789,3.44559615702311e-6,0.0106435736301348,0.00618456916816344,-0.580364519560921,0.79788971639797,0.727374357174253,3.77724587061794e-6,0.0108458032570814,0.0062709925656568,-0.57744538321728,0.787145027954362,0.733594652459343,4.13984272626852e-6,0.0110616201130886,0.00636167584824104,-0.574306112758136,0.776191316269277,0.73990278004978,4.53755155230205e-6,0.0112924563881866,0.00645701603537933,-0.570932549062999,0.765014278018639,0.746303128539895,4.97528192515763e-6,0.0115399621602607,0.00655746545864941,-0.567309004037076,0.753598068744416,0.752800501442739,5.45885777545193e-6,0.0118060494387462,0.00666354225306852,-0.563418023328266,0.741925062944912,0.75940017593138,5.99523470517049e-6,0.0120929475270781,0.0067758434155973,-0.559240099973685,0.729975564462,0.76610797292352,6.59278124133961e-6,0.0124032732940869,0.00689506121407079,-0.554753326050002,0.717727454051418,0.772930341341324,7.26164681845909e-6,0.0127401213216587,0.00702200402095458,-0.549932965190932,0.705155756743545,0.779874460261884,8.01424897573031e-6,0.013107180902658,0.0071576230672028,-0.544750922961633,0.692232105631387,0.786948363894165,8.86592681233523e-6,0.0135088898387767,0.00730304723058357,-0.539175083759171,0.678924070260669,0.794161096029719,9.83583001943527e-6,0.013950639486228,0.00745962890109552,-0.533168470918967,0.665194305598167,0.801522903055405,0.0000109481476048085,0.0144390524432863,0.00762900538773551,-0.526688169103146,0.65099945963341,0.809045478163275,0.0000122338360391399,0.0149823652560863,0.00781318256008322,-0.519683921652326,0.636288750783723,0.816742274654747,0.0000137330977170118,0.0155909663483276,0.00801465100723293,-0.512096275070764,0.621002084981516,0.824628914226602,0.0000154990143650173,0.0162781691996597,0.00823655094979559,-0.503854078973507,0.605067517207523,0.832723728583,0.0000176030077089061,0.0170613523842926,0.00848291235559705,-0.494871046157729,0.588397756415547,0.841048492727825,0.000020143282982939,0.0179636908525791,0.0087590149326288,-0.485040903237115,0.570885234797111,0.849629441562797,0.0000232583203906172,0.0190168773410386,0.00907194668471846,-0.474230357559973,0.552394950700302,0.858498719003069,0.0000271492758426815,0.0202655788306421,0.00943150666567285,-0.462268547576477,0.532753722614462,0.86769651333062,0.0000321189061381808,0.021775103805448,0.00985173802052284,-0.448930560894273,0.511733381296417,0.877274333280662,0.0000386430270482309,0.0236454228875346,0.0103536958939784,-0.433910355832457,0.489023117949925,0.887300292983058,0.0000475108898572291,0.0260388707359228,0.0109708510585626,-0.416773335143034,0.464180971138196,0.897868204551952,0.0000601257010681203,0.0292407625819033,0.0117607905121176,-0.396865949089532,0.436541154479283,0.909114627606927,0.0000792251955098358,0.0338123222329265,0.0128345139219604,-0.373121732746276,0.405014612071868,0.921254990869482,0.000110905090097512,0.041069977160908,0.0144481062962488,-0.343562165216683,0.367573462374951,0.934676195057371,0.000171848750150267,0.0553162230137762,0.0174349320874985,-0.303499767018805,0.319380362287609,0.950276857490371,0.000329437510061586,0.0291722250780721,0.00796829280159659,-0.266695255049859,0.277136138241685,0.962325796779628,0.000094905792490916,0.0291722250780721,0.0227661207410025,-0.240456733968857,0.247963913163613,0.969724710749331,0.000097174644894981,0.0291722250780721,0.0360152325854855,-0.213617104216153,0.218791688085541,0.976349266671573,0.0000992107606094019,0.0291722250780721,0.0476824305859455,-0.186240987563824,0.189619463007469,0.982182865671803,0.000101005632487948,0.0291722250780721,0.0577383540895109,-0.158395250514108,0.160447237929397,0.987210827423585,0.000102551729194003,0.0291722250780721,0.0661576026394334,-0.130148732537793,0.131275012851324,0.991420451698547,0.000103842539427359,0.0291722250780721,0.0729188428730596,-0.101571962712168,0.102102787773252,0.99480107181536,0.000104872610302731,0.0291722250780721,0.0780048985882543,-0.0727368663898667,0.0729305626951802,0.997344099672957,0.000105637579589259,0.0291722250780721,0.0814028234460858,-0.0437164636054833,0.0437583376171081,0.999043062101873,0.000106134201565975,0.0291722250780721,0.0831039558790759,-0.0145845609897168,0.014586112539036,0.999893628318368,0.000106360366296287};
static uint32_t ZMG_restprob[264]=
{4288688127,4213967871,3299469311,4108230655,4240671743,4294131711,4237360127,4294928383,4279267327,4247223295,4294659071,3914677247,3500325887,4131409919,4185106431,4294966271,4294019071,4272718847,4228113407,4205695999,4288073727,4294540287,4291973119,4294280191,4292123647,4243212287,4233454591,4211117055,4206403583,4220588031,4294955007,4281226239,4294964223,4282080255,4292222975,4277842943,4219192319,4163587071,4110817279,4060689407,4013031423,3967683583,3924502527,3883356159,3844122623,3806691327,3770961919,3736838143,3704233983,3673070591,3643273215,3614773247,3587507199,3561415679,3536443391,3512540159,3489656831,3467750399,3446777855,3426702335,3407484927,3389091839,3371492351,3354656767,3338554367,3323161599,3308451839,3294401535,3280989183,3268193279,3255995391,3244377087,3233319935,3222807551,3212824575,3203357695,3194391551,3185912831,3177911295,3170373631,3163288575,3156646911,3150439423,3144654847,3139286015,3134324735,3129762815,3125593087,3121808383,3118403583,3115371519,3112707071,3110405119,3108460543,3106869247,3105626111,3104728063,3104171007,3103951871,3104067583,3104515071,3105293311,3106398207,3107828735,3109582847,3111659519,3114057727,3116776447,3119813631,3123170303,3126845439,3130840063,3135152127,3139784703,3144735743,3150008319,3155602431,3161519103,3167760383,3174328319,3181223935,3188449279,3196007423,3203900415,3212132351,3220704255,3229621247,3238886399,3248502783,3258475519,3268807679,3279504383,3290571775,3302012927,3313833983,3326040063,3338638335,3351634943,3365036031,3378848767,3393080319,3407737855,3422829567,3438364671,3454351359,3470798847,3487716351,3505114111,3523003391,3541394431,3560298495,3579728895,3599695871,3620214783,3641297919,3662960639,3685217279,3708084223,3731576831,3755712511,3780509695,3805986815,3832164351,3859061759,3886701567,3915105279,3944297471,3974302719,4005146623,4036857855,4069464063,4102995967,4137484287,4172962815,4209467391,4247033855,4285701119,4281365503,4294856703,4283079679,4291927039,4292237311,4294095871,4293057535,4292675583,4289917951,4238869503,4187456511,4201339903,4215447551,4235679743,4207845375,4247621631,4274362367,4294724607,4294511615,4291477503,4293617663,4294002687,4292563967,4290989055,4252033023,4247414783,993233919,4227144703,4237752319,4222645247,4250822655,4291044351,4291227647,4294860799,4294964223,4294962175,4250316799,4232491007,4230988799,3233552383,3409166335,3594597375,3790680063,3998348287,4218647551,4290561023,4266098687,4252657663,4291688447,4294958079,4216662015,4249108479,4294285311,4253692927,3181783039,3670461439,4205655039,4207465471,4294967295,4228380671,4286908415,3590419455,4281718783,4245543935,4214110207,4294878207,4269671423,4291320831,4211460095,4236848127,4290747391,3961292799,4014740479,4294880255,4291094527,4269922303,4294958079,4285769727,4294892543,4236495871,4234860543,4274366463,4283554815,4294351871,4228534271,4223247359,4249466879};
static int ZMG_jump[1024]=
{21,179,260,211,210,250,255,15,196,195,226,185,236,226,32,235,242,16,178,222,198,210,235,32,15,229,222,229,180,196,235,184,15,244,10,225,10,198,0,199,15,30,259,237,201,29,202,227,28,14,188,27,9,256,26,261,206,228,192,246,193,17,24,208,195,23,251,16,235,22,198,211,8,200,20,240,213,227,14,241,205,256,261,206,6,246,243,208,247,251,229,255,15,237,213,245,241,261,6,215,214,14,257,230,212,211,210,16,209,7,17,207,228,262,215,236,18,4,214,19,245,202,230,237,201,212,15,199,226,255,210,197,229,196,209,247,7,225,194,258,243,252,207,25,6,191,262,215,18,204,190,224,189,1,214,241,187,234,245,257,213,230,240,223,20,254,212,200,183,21,31,182,181,255,197,226,180,251,211,209,253,229,178,23,16,32,197,250,253,5,22,210,181,10,253,30,226,194,212,195,212,239,34,13,23,182,251,177,178,242,235,15,235,179,180,32,21,263,4,186,239,260,23,199,33,30,235,16,247,7,31,257,19,242,22,235,242,183,205,200,235,33,15,260,7,235,211,194,184,8,212,250,5,32,22,211,198,209,185,222,255,250,253,0,262,262,261,262,261,262,261,262,261,262,260,261,262,260,261,262,260,261,262,260,261,262,260,261,262,260,259,261,262,260,259,261,262,260,259,261,262,260,259,261,262,260,259,261,262,260,259,261,262,260,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,262,256,260,258,259,261,257,255,262,256,260,258,259,261,257,255,262,256,260,258,259,261,257,255,262,256,260,258,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,259,261,257,255,262,256,260,258,252,263,259,261,257,255,262,256,260,258,252,263,254,259,261,257,255,262,256,260,258,252,263,254,259,261,257,255,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,261,257,255,251,262,256,260,258,252,263,254,259,250,261,257,255,251,262,256,260,258,252,263,254,259,250,261,257,255,251,262,256,260,258,252,263,254,259,250,261,257,255,251,262,256,260,258,252,263,254,259,250,249,261,257,255,251,262,256,260,258,252,263,254,259,250,249,261,257,255,251,262,256,260,258,252,263,254,259,250,249,248,261,257,255,251,262,256,260,258,252,263,254,259,0,250,249,248,261,257,255,251,247,262,256,260,258,252,263,254,259,0,250,253,249,248,261,257,255,251,247,246,262,256,260,258,252,263,254,259,0,250,253,249,248,261,245,257,255,251,247,246,262,256,260,258,252,263,1,254,259,0,250,253,244,249,248,261,245,257,255,251,247,243,246,262,256,260,258,252,263,1,254,259,0,250,253,242,244,249,248,2,261,241,245,257,255,251,247,243,246,262,256,240,260,258,252,263,1,254,259,239,0,250,253,242,244,3,249,248,238,2,261,241,245,257,237,255,251,247,243,246,262,236,256,4,240,235,260,258,252,263,1,234,254,259,239,0,250,253,242,5,244,233,3,249,248,232,238,2,231,6,261,241,245,257,230,237,255,229,251,247,7,243,246,228,262,236,256,4,227,240,8,226,235,260,225,258,252,263,224,9,1,234,223,254,259,239,0,250,253,242,222,5,10,244,221,233,3,249,220,248,11,219,232,218,238,12,217,2,216,231};
/* For definitions of ZMG_STATE, ZMG_SEED_t, ZMG_U32, ZMG_SEED, see zmg.h */
/* IEEE 754 double constants, used for type-punning */
#define D_ONE_MSB 0x3ff00000
#define D_MANTISSA 0xfffff

double zmgd(ZMG_STATE *rng_p1, ZMG_STATE *rng_p2) {
	union {
		uint64_t ii;
		uint32_t i[2];
	} u;
	union {
		double r;
		uint32_t i[2];
	} x, y, z;
	uint64_t r,s;
	double *p,mx;

	u.i[0] = ZMG_U32(rng_p1);
	u.i[1] = ZMG_U32(rng_p2);
	r = u.ii & ZMG_RMASK;
	s = (u.ii & (1 << ZMG_MR)) << (31-ZMG_MR);
	u.ii >>= ZMG_MR+1;
	if (r<ZMG_R) {
		x.r = (double)u.ii * ZMG_Rect[r];
		/* assume rectangle width scaled by 2^(63-ZMG_MR) */
	} else {
		r = u.ii & ZMG_TMASK;  /* use alias-urn method to select a left-over */
		if (r >= ZMG_T) {
			r = ZMG_jump[r];
		} else if (ZMG_U32(rng_p1)  >= ZMG_restprob[r]) {
			r=ZMG_jump[r];
		}
		if (r < ZMG_T-1) { /* sample from a trapezoid */
			p = ZMG_Trap + 6*r;
			do {
				x.i[0] = ZMG_U32(rng_p1);
				x.i[1] = (ZMG_U32(rng_p2) & D_MANTISSA)
					^ D_ONE_MSB; /* ~Unif[1,2) */
				x.r = (x.r - 1.5) * p[0];  /* ~Unif[-dx/2,dx/2] */
				y.i[0] = ZMG_U32(rng_p1);
				y.i[1] = (ZMG_U32(rng_p2) & D_MANTISSA)
					^ D_ONE_MSB; /* ~Unif[1,2) */
				y.r = (y.r - 1.5) * p[1];  /* ~Unif[-dy/2,dy/2] */
				mx = p[2] * x.r;
				if (y.r > mx) {
					x.r = -x.r;
					y.r = -y.r;
				}
				x.r += p[3];
				if (y.r <= mx - p[5]) { /* in quick-accept region? */
					break;
				}
				y.r += p[4];
			} while (y.r > exp(-0.5*x.r*x.r));
		} else { /* sample from the tail */
			do {
				x.i[0] = ZMG_U32(rng_p1);
				x.i[1] = (ZMG_U32(rng_p2) & D_MANTISSA)
					^ D_ONE_MSB;
				x.r = ZMG_A + ZMG_K*log(2.0-x.r);
				y.r = x.r - ZMG_LAMBDA;
				z.i[0] = ZMG_U32(rng_p1);
				z.i[1] = (ZMG_U32(rng_p2) & D_MANTISSA)
					^ D_ONE_MSB;
			} while (z.r >= 1.0 + exp(-0.5*y.r*y.r));
		}
	}
	x.i[1] ^= s;
	return x.r;
}

void seedzmgd(ZMG_STATE *rng_p1,ZMG_STATE *rng_p2) {
	ZMG_SEED_t seed1,seed2;
	union {
		double r;
		uint32_t i[2];
	} x;
	x.i[0] = 0;
	x.i[1] = D_ONE_MSB;
	if (x.r != 1.0) {
		fprintf(stderr,
			"Floating point representation or endianness incompatible with zmgd -- sorry.\n");
		exit(1);
	}
	/*if ((getentropy(&seed1,sizeof(ZMG_SEED_t)) != 0) ||
	    (getentropy(&seed2,sizeof(ZMG_SEED_t)) != 0))
	{
	   fprintf(stderr,"Failed to get entropy to seed random number generator.\n");
	   exit(1);
	}*/

	// Hard-coded for hash repeatability. -KM
	seed1 = 1234;
	seed2 = 2345;
	ZMG_SEED(rng_p1,seed1);
	ZMG_SEED(rng_p2,seed2);
}
