This contains code directly copied from earlier simulators. The code is so
complex that I'm not going to try to clean it up. It's just for testing, so
that I can see which methods perform well, if any, and then focus my attention
on recreating them.
